# Mac(Medium Access Control Sublayer)
所有网络有公共的资源分配的问题

用来确定**多路访问信道下一个使用者**的的协议属于数据链路层的一个子层-MAC

## 信道分配问题
Single Channel，没有别的通道可以走，因此需要竞争

### 静态信道分配
传统做法是把信道容量拆开分给多个用户使用
XX多路复用技术

假设有N个用户，将整个带宽分成N等份
- 此时很少用户，浪费带宽
- 此时很多用户，有些用户因带宽不够而被拒绝

不适应突发性的流量

### 动态信道分配假设Assumption for Dynamic Channel Allocation
关键假设
- 流量独立
    N个独立的站组成，每个站都有一个程序/用户产生要传输的帧。在长度为$\Delta t$的间隔内，期望产生的帧数为$\lambda \Delta t$。其中$\lambda$为常数，新帧的到达率。一旦生成出一帧，则站就被**阻塞**，直到该帧成功发送出去。
- 单信道
    所有通信都是用一个信道。所有的站可以在该信道上传输数据，也可以接收数据。所有站的能力相同(但是协议可能分配不同的角色(优先级))
- 冲突可观察
    若两帧同时传输，时间上重叠，产生的信号时混乱的，即为**冲突**。所有的站都能够检测到冲突事件的发生。冲突的帧需要再次发送。
    除了因冲突而产生错误外，不会再有其他的错误。
- 时间连续/分槽
    时间假设连续，即任何时刻都可以开始传输帧。
    可以假设不连续，把时间分成离散的间隔(时间槽)。帧的传输只能从某个时间槽的起始点开始。一个时间槽对应0、1或多个帧，对应空闲、一次发送成功或一次冲突
- 载波侦听/不听
    CSMA/CD(允许冲突存在)
    站需要用信道之前应该直到信道当前是否正在被使用，信道忙就不去用。
    如果没有载波侦听，站盲目传输，以后再判断是否成功

## 多路访问协议MUltiple Access Protocol
### ALOHA
![](./ref/note4-1.PNG)
#### pure ALOHA
用户有数据**需要发送时就传输**，可能会冲突碰撞损坏，帧损坏了就等待**随机**一段时间再发送
#### Slotted ALOHA
将时间分成离散的时间间隔(时间槽)，每个时间槽对应一帧
取得同步时间的一种方法是由一个**特殊的站**在每个时间间隔的起始发送脉冲信号
不允许用户每次有数据就力矩发送，而是等待下一个时间槽的开始时刻
### Carrier Sense Multiple Access
![](./ref/note4-2.PNG)
载波侦听多路访问协议

站监听是否存在载波(是否由传输)，据此采取相应动作
#### 坚持和非坚持CSMA
- 1-persistent CSMA: 最简单的CSMA，一个站有数据要发送的时候，首先侦听信道，确定有载波就一直等到空闲，没有就发送。如果还冲突了还是等待**随机**一段时间
- nonpersistent CSMA: 发送数据之前先侦听信道。没有载波就发送，有则并不持续对信道监听。直接等待**随机**一段时间，然后重复上述步骤
- p-persistent CSMA: 使用于分时间槽的信道。数据准备好，就侦听信道，空闲就**按照概率p发送数据**，以概率**1-p的概率推迟到下一个时间槽**

#### CSMA with Collision Detection
带冲突检测的CSMA/CD广泛使用
坚持和非坚持CSMA协议确保了信道忙时，所有的站都不再传输数据。
但如果**两个站都侦听到信道为空，并且同时开始传输，则它们的信号仍然会产生冲突**
这里改进是**每个站快速检测到发送冲突后立即停止传输帧**

站的硬件在传输时侦听信道，如果他读回的信号**不同于**它写到信道上的信号，就知道发送了collision，就立即终止自己的传送，等待**随机**一段时间
(根据**自身**的状况，想发就发，不用管其他的)

简单，差错小

侦听实现流量控制

但这里似乎没有处理出错的机制，其实是交给上一层(网络层)纠错了

![](./ref/note4-3.PNG)
假设两个站同时在$t_0$时刻开始传输数据，需要多长时间才能意识到发生了冲突呢
检测冲突的最小时间，是将信号从一个站传播到另一个站所需要的时间

### Collision-free Protocols
#### Bitmap Protocol
位图协议
![](./ref/note4-4.PNG)
事实上存在着很大的问题，如何把节奏统一起来，在规定的时间确定竞争位槽
如果有专门的管理机构维护整个系统的通信，但是不扁平化了，在现有主流的系统中不受欢迎

#### Tokon Ring 传递
令牌代表了发送权限，如果一个站有等待传输的帧队列，接收到令牌后就可以发送帧，然后再把令牌传递到下一站

![](./ref/note4-5.PNG)

#### 二进制倒计数Binary Countdown
根据站的地址(本身属性)排序
但是存在某个站算出来的就是小那么就一直在后排

### LImited-contention Protocols
### Wireless LAN Protocols


## hw
1, 6, 8, 10, 13, 16, 18, 25, 38